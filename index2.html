<!DOCTYPE html>
<html>
  <head>
    <script src="stream.js" type="text/javascript"></script>
    <script>
      window.addEventListener("load", function() {
        return
        
        function extend(a, b) {
            if (a !== undefined && typeof a !== typeof b)
              return a
            
            if (b instanceof Array) {
              if (a === undefined)
                a = []
                
              for (var i = 0; i < b.length; ++i)
                a[i] = extend(a[i], b[i])
                
              return a
            } 
            else if (b instanceof Object) {
              if (a === undefined)
                a = {}
                
              for (var key in b) {
                if (b.hasOwnProperty(key))
                  a[key] = extend(a[key], b[key])
              }
              return a
            }
            else {
              return b
            }
        }
        
        function fill(shape, col) { shape.fill = col; return shape }
        function move(shape, x, y) { shape.x += x; shape.y += y; return shape }
        function rotate(shape, deg) { shape.rot += deg; return shape }
        function scale(shape, sc) { shape.scale += val; return shape }
        function stroke(shape, col) { shape.stroke = col; return shape }
        function shape(x, y, deg, sc) { return {type:'shape', x:x||0, y:y||0, rot:deg||0, scale:sc||1} }
        function rect(x, y, w, h) { return extend(shape(x, y), {type:'rect', w:w, h:h}) }
        function image(src, x, y) { return extend(shape(x, y), {type:'image', src:src}) }

        function html(base, shapes) {
          var elm = document.querySelector(base)

          var innerHTML = ''
          for (var i = 0; i < shapes.length; ++i) {
            var shape = shapes[i]
            switch (shape.type) {
              case 'rect':
                innerHTML += `<div class="rect" style="left:${shape.x}px; top:${shape.y}px; width:${shape.w}px; height:${shape.h}px; background-color:${shape.fill}; outline:1px solid ${shape.stroke}"></div>\n`
                break
                
              case 'image':
                innerHTML += `<img src=${shape.src} class="rect" style="left:${shape.x}px; top:${shape.y}px;">\n`
                break
            }
          }
          
          elm.innerHTML = innerHTML
        }

        var rect1 = stroke(fill(rect(10, 30, 20, 20), 'lightblue'), 'black')
        var image1 = image('images/mario_walk_left.gif', 50, 50)
        html('body', [rect1, image1])
      })
    </script>
    <style>
      .rect {
        position: absolute;
        display: block;
      }
    </style>
  </head>
  <body>
    <div style="transform:rotate(-90deg)">
      <img src="images/mario_walk_left.gif" style="position:absolute;left:140px">
    </div>
  </body>
</html>